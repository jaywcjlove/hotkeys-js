<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotkeys.js - Layout Independence Test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    h1 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 32px;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 16px;
    }
    
    .info-box {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 20px;
      margin-bottom: 30px;
      border-radius: 4px;
    }
    
    .info-box h2 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 20px;
    }
    
    .info-box p {
      line-height: 1.6;
      color: #555;
    }
    
    .hotkeys-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .hotkey-card {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
      transition: all 0.3s ease;
    }
    
    .hotkey-card:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }
    
    .hotkey-card.active {
      background: #667eea;
      border-color: #667eea;
      color: white;
      animation: pulse 0.5s ease;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .hotkey-combo {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
    }
    
    .hotkey-desc {
      font-size: 14px;
      opacity: 0.8;
    }
    
    .log-container {
      background: #1e1e1e;
      border-radius: 8px;
      padding: 20px;
      margin-top: 30px;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .log-title {
      color: #4ec9b0;
      font-weight: bold;
      margin-bottom: 10px;
      font-family: 'Monaco', 'Courier New', monospace;
    }
    
    .log-entry {
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      padding: 8px;
      margin-bottom: 4px;
      border-radius: 4px;
      background: #2d2d2d;
      color: #d4d4d4;
      line-height: 1.5;
    }
    
    .log-entry .timestamp {
      color: #858585;
    }
    
    .log-entry .hotkey {
      color: #4ec9b0;
      font-weight: bold;
    }
    
    .log-entry .event {
      color: #dcdcaa;
    }
    
    .log-entry .code {
      color: #ce9178;
    }
    
    .keyboard-status {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .key-indicator {
      padding: 8px 16px;
      background: #e9ecef;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .key-indicator.pressed {
      background: #667eea;
      color: white;
      transform: scale(1.1);
    }
    
    .alert {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      color: #856404;
    }
    
    .alert strong {
      display: block;
      margin-bottom: 5px;
    }
    
    .clear-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      margin-top: 10px;
    }
    
    .clear-btn:hover {
      background: #5568d3;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    .clear-btn:active {
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéπ Hotkeys.js - Layout Independence Test</h1>
    <p class="subtitle">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Ö–æ—Ç–∫–µ–µ–≤ –Ω–∞ –ª—é–±–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</p>
    
    <div class="alert">
      <strong>üí° –í–∞–∂–Ω–æ:</strong>
      –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Ä—É—Å—Å–∫—É—é) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ö–æ—Ç–∫–µ–∏ - –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!
      <br><br>
      <strong>‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong>
      –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è QWERTY-based –∫–ª–∞–≤–∏–∞—Ç—É—Ä (95%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π). 
      AZERTY/Dvorak —Ç—Ä–µ–±—É—é—Ç –Ω–∞–∂–∞—Ç–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø–æ–∑–∏—Ü–∏–π QWERTY.
    </div>
    
    <div class="info-box">
      <h2>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h2>
      <p>
        –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç <code>event.code</code> –≤–º–µ—Å—Ç–æ <code>event.keyCode</code>.
        –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ö–æ—Ç–∫–µ–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ <strong>—Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é –∫–ª–∞–≤–∏—à</strong>,
        –∞ –Ω–µ –ø–æ —Å–∏–º–≤–æ–ª–∞–º. –ö–æ–º–±–∏–Ω–∞—Ü–∏—è <code>Ctrl+A</code> –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ª—é–±–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–µ!
      </p>
    </div>
    
    <h3 style="margin-bottom: 15px; color: #667eea;">–¢–µ–∫—É—â–∏–µ –Ω–∞–∂–∞—Ç—ã–µ –∫–ª–∞–≤–∏—à–∏:</h3>
    <div class="keyboard-status" id="keyboardStatus">
      <span class="key-indicator">–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É...</span>
    </div>
    
    <h3 style="margin-bottom: 15px; color: #667eea;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ö–æ—Ç–∫–µ–∏:</h3>
    <div class="hotkeys-grid" id="hotkeysGrid">
      <!-- Will be populated by JavaScript -->
    </div>
    
    <div class="log-container">
      <div class="log-title">üìã Event Log (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è)</div>
      <button class="clear-btn" onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
      <div id="eventLog"></div>
    </div>
  </div>
  
  <script src="../dist/hotkeys.js"></script>
  <script>
    // Hotkey definitions
    const hotkeyDefinitions = [
      { combo: 'ctrl+a', desc: '–í—ã–¥–µ–ª–∏—Ç—å –≤—Å—ë', action: 'selectAll' },
      { combo: 'ctrl+s', desc: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å', action: 'save' },
      { combo: 'ctrl+z', desc: '–û—Ç–º–µ–Ω–∏—Ç—å', action: 'undo' },
      { combo: 'ctrl+y', desc: '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å', action: 'redo' },
      { combo: 'ctrl+f', desc: '–ù–∞–π—Ç–∏', action: 'find' },
      { combo: 'ctrl+shift+s', desc: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫', action: 'saveAs' },
      { combo: 'f5', desc: '–û–±–Ω–æ–≤–∏—Ç—å', action: 'refresh' },
      { combo: 'esc', desc: '–û—Ç–º–µ–Ω–∞', action: 'cancel' },
    ];
    
    // Populate hotkeys grid
    const grid = document.getElementById('hotkeysGrid');
    hotkeyDefinitions.forEach(({ combo, desc, action }) => {
      const card = document.createElement('div');
      card.className = 'hotkey-card';
      card.id = `card-${action}`;
      card.innerHTML = `
        <div class="hotkey-combo">${combo}</div>
        <div class="hotkey-desc">${desc}</div>
      `;
      grid.appendChild(card);
    });
    
    // Log function
    function log(message, hotkey, eventCode = '') {
      const logDiv = document.getElementById('eventLog');
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      const timestamp = new Date().toLocaleTimeString('ru-RU');
      entry.innerHTML = `
        <span class="timestamp">[${timestamp}]</span>
        <span class="hotkey">${hotkey}</span>
        <span class="event">${message}</span>
        ${eventCode ? `<span class="code">(${eventCode})</span>` : ''}
      `;
      logDiv.insertBefore(entry, logDiv.firstChild);
      
      // Keep only last 20 entries
      while (logDiv.children.length > 20) {
        logDiv.removeChild(logDiv.lastChild);
      }
    }
    
    function clearLog() {
      document.getElementById('eventLog').innerHTML = '';
    }
    
    // Highlight card animation
    function highlightCard(action) {
      const card = document.getElementById(`card-${action}`);
      if (card) {
        card.classList.add('active');
        setTimeout(() => card.classList.remove('active'), 500);
      }
    }
    
    // Register hotkeys
    hotkeyDefinitions.forEach(({ combo, desc, action }) => {
      hotkeys(combo, function(event, handler) {
        event.preventDefault();
        const eventCode = event.code || `keyCode: ${event.keyCode}`;
        log(`‚úì –•–æ—Ç–∫–µ–π —Å—Ä–∞–±–æ—Ç–∞–ª: ${desc}`, combo, eventCode);
        highlightCard(action);
      });
    });
    
    // Monitor all keys
    hotkeys('*', function(event) {
      updateKeyboardStatus();
    });
    
    // Update keyboard status display
    function updateKeyboardStatus() {
      const pressed = hotkeys.getPressedKeyString();
      const statusDiv = document.getElementById('keyboardStatus');
      
      if (pressed.length === 0) {
        statusDiv.innerHTML = '<span class="key-indicator">–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É...</span>';
      } else {
        statusDiv.innerHTML = pressed.map(key => 
          `<span class="key-indicator pressed">${key}</span>`
        ).join('');
      }
    }
    
    // Clear status on key release
    document.addEventListener('keyup', () => {
      setTimeout(updateKeyboardStatus, 10);
    });
    
    // Initial log message
    log('üöÄ Hotkeys.js –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!', '–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞', 'Layout-independent mode');
    log('üí° –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥–∫—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ö–æ—Ç–∫–µ–∏', '–ü–æ–¥—Å–∫–∞–∑–∫–∞', '');
    
    // Display browser support info
    setTimeout(() => {
      const supportsCode = 'code' in KeyboardEvent.prototype;
      log(
        supportsCode 
          ? '‚úì –ë—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç event.code - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ä–µ–∂–∏–º'
          : '‚ö† –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç event.code - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ keyCode',
        '–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å',
        supportsCode ? 'modern' : 'legacy'
      );
    }, 100);
  </script>
</body>
</html>
